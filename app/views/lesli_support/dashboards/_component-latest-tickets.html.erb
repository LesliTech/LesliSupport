<%
tickets = current_user.account.support.tickets.left_joins(
    :user, 
    :owner, 
    :priority
).select(
    :uid,
    :subject,
    Date2.new.db_column(:deadline_at),
    "CONCAT_WS(' ', lesli_users.first_name, lesli_users.last_name) as user_name",
    "CONCAT_WS(' ', owners_lesli_support_tickets.first_name, owners_lesli_support_tickets.last_name) as agent_name",
    "lesli_support_catalog_items.name as priority_name"
).order(id: :desc)
.limit(5)
%>

<%
columns = [{
    label: "ID",
    field: "number"
}, {
    label: "Subject",
    field: "subject"
}, {
    label: "Priority",
    field: "priority_name"
}]
%>

<%= render(LesliView::Elements::Table.new(
    :columns => columns,
    :records => tickets,
    #link: -> (ticket) { ticket_path(ticket.id) }
)) %>
